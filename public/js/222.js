"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[222],{6573:(e,t,s)=>{function n(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}s.d(t,{Z:()=>a});var r=s(9669);const a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,s,a;return t=e,(s=[{key:"get",value:function(e){return r.get("/api/".concat(e)).then((function(e){return e})).catch((function(e){return e}))}},{key:"post",value:function(e,t){return r.post("/api/".concat(e),t).then((function(e){return e})).catch((function(e){return e}))}}])&&n(t.prototype,s),a&&n(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}())},4222:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var n=s(7757),r=s.n(n),a=s(6573);function i(e,t,s,n,r,a,i){try{var o=e[a](i),u=o.value}catch(e){return void s(e)}o.done?t(u):Promise.resolve(u).then(n,r)}function o(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var a=e.apply(t,s);function o(e){i(a,n,r,o,u,"next",e)}function u(e){i(a,n,r,o,u,"throw",e)}o(void 0)}))}}const u={mounted:function(){var e=this;return o(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.Z.get("support-messages-thread-admin").then((function(e){return e.data}));case 2:e.threads=t.sent,setInterval((function(){a.Z.get("support-messages-thread-admin").then((function(e){return e.data})).then((function(t){e.threads=[],e.threads=t}))}),4e3);case 4:case"end":return t.stop()}}),t)})))()},data:function(){return{threads:[],selectedItem:null,messages:[],messagePages:0,messagePage:1,fetchMore:!0,inputDisabled:!1,messageBox:""}},watch:{selectedItem:function(){this.fetchMore=!0,this.messages=[],this.messagePages=0,this.messagePage=0,this.getMessage()}},computed:{user:function(){return this.$store.getters.loggedInUser}},methods:{getMessage:function(){var e=this;a.Z.get("support-messages/"+this.threads[this.selectedItem].id).then((function(e){return e.data})).then((function(t){e.messages=t}))},readMessage:function(e){if(13==e.keyCode&&e.shiftKey){e.preventDefault();var t=this.messageBox;return this.sendMessage(t),!1}},sendMessage:function(e){var t=this;return o(r().mark((function s(){var n;return r().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t.inputDisabled=!0,(n=new FormData).append("message",e),s.next=5,a.Z.post("support-messages/"+t.threads[t.selectedItem].id,n).then((function(e){return e.data.data})).then((function(e){t.messages.push(e)}));case 5:t.messageBox="",t.inputDisabled=!1;case 7:case"end":return s.stop()}}),s)})))()}}};const c=(0,s(1900).Z)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"pa-4",attrs:{cols:"3"}},[s("v-list",{attrs:{elevation:"3"}},[s("v-list-item-group",{attrs:{color:"primary"},model:{value:e.selectedItem,callback:function(t){e.selectedItem=t},expression:"selectedItem"}},e._l(e.threads,(function(t){return s("v-list-item",{key:t.id},[s("v-list-item-avatar",[s("v-img",{attrs:{src:t.user_id==e.user.id?t.to.image_url:t.user.image_url}})],1),e._v(" "),s("v-list-item-content",[s("v-list-item-title",{domProps:{textContent:e._s(t.user_id==e.user.id?t.to.name:t.user.name)}})],1),e._v(" "),s("v-list-item-icon",[s("v-badge",{attrs:{content:t.messages_count,value:t.messages_count,color:"green",overlap:""}},[s("v-icon",[e._v("\n                                    mdi-message-outline\n                                ")])],1)],1)],1)})),1)],1)],1),e._v(" "),s("v-col",{staticClass:"pa-4",attrs:{cols:"9"}},[s("v-list",e._l(e.messages,(function(t){return s("v-list-item",{key:t.id},[t.user_id!=e.user.id?s("v-list-item-avatar",[s("v-img",{attrs:{src:t.user.image_url}})],1):e._e(),e._v(" "),s("v-list-item-content",[s("v-list-item-title",{class:t.user_id==e.user.id?"text-right":"",domProps:{innerHTML:e._s(t.message)}})],1),e._v(" "),t.user_id==e.user.id?s("v-list-item-avatar",[s("v-img",{attrs:{src:t.user.image_url}})],1):e._e()],1)})),1),e._v(" "),parseInt(e.selectedItem)>=0?s("v-row",[s("v-col",{attrs:{cols:"12",sm:"12"}},[s("v-textarea",{attrs:{clearable:"",disabled:e.inputDisabled,label:"Type Message","auto-grow":"",outlined:"",rows:"1","row-height":"15",hint:"Shift+Enter to Send","persistent-hint":""},on:{keydown:e.readMessage},model:{value:e.messageBox,callback:function(t){e.messageBox=t},expression:"messageBox"}})],1)],1):e._e()],1)],1)],1)}),[],!1,null,null,null).exports}}]);